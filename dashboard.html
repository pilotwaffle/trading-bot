<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Industrial Crypto Trading Dashboard</title>
  <link rel="stylesheet" href="static/css/dashboard.css">
</head>
<body>
  <!-- Main Alert -->
  <div id="main-alert" class="alert" style="display:none;"></div>

  <!-- Tab Navigation -->
  <nav class="dashboard-tabs">
    <button class="tab-btn active" onclick="showTab('dashboard')">Dashboard</button>
    <button class="tab-btn" onclick="showTab('ml-train')">Train Bot</button>
    <button class="tab-btn" onclick="showTab('crypto-prices')">Crypto Prices</button>
    <button class="tab-btn" onclick="showTab('system-status')">System Status</button>
  </nav>

  <!-- Dashboard Main Content -->
  <section id="tab-dashboard" class="tab-content active">
    <!-- Trading Section -->
    <section>
      <h2>Trade</h2>
      <form id="trade-form" onsubmit="executeTrade(event)">
        <select id="trade-symbol" name="symbol"></select>
        <select name="side">
          <option value="buy">Buy</option>
          <option value="sell">Sell</option>
        </select>
        <input type="number" step="any" name="amount" placeholder="Amount" required>
        <input type="number" step="any" name="price" placeholder="Price (optional)">
        <button type="submit">Submit Trade</button>
      </form>
    </section>

    <!-- Positions Section -->
    <section>
      <h2>Positions</h2>
      <div id="positions-content"></div>
    </section>

    <!-- Crypto Market -->
    <section>
      <h2>Market</h2>
      <div id="crypto-grid"></div>
    </section>

    <!-- Strategies Section -->
    <section>
      <h2>Strategies</h2>
      <div id="strategies-content"></div>
    </section>

    <!-- Analytics Section -->
    <section>
      <h2>Analytics</h2>
      <div id="analytics-summary"></div>
    </section>

    <!-- Bot Control -->
    <section>
      <h2>Bot Control</h2>
      <span id="bot-status" class="status-indicator status-stopped">‚óè Stopped</span>
      <button id="toggle-bot" class="btn btn-success" onclick="toggleBot()">Start Bot</button>
      <button onclick="syncData()">Sync Data</button>
    </section>

    <!-- Chat Section -->
    <section>
      <h2>Chat</h2>
      <div id="chat-messages" style="height:200px;overflow-y:auto;background:#f7f7f7;padding:8px;margin-bottom:8px;"></div>
      <input id="chat-input" type="text" placeholder="Type a message..." onkeypress="handleChatKeyPress(event)">
      <button onclick="sendChatMessage()">Send</button>
    </section>
  </section>

  <!-- ML Training Tab -->
  <section id="tab-ml-train" class="tab-content">
    <h2>Train Bot</h2>
    <form id="training-form">
      <label for="training-type">Training Type:</label>
      <select id="training-type">
        <option value="supervised">Supervised Learning</option>
        <option value="reinforcement">Reinforcement Learning</option>
        <option value="deep">Deep Learning</option>
      </select>
      <label for="training-symbol">Symbol:</label>
      <select id="training-symbol">
        <option value="BTC">BTC</option>
        <option value="ETH">ETH</option>
        <option value="SOL">SOL</option>
        <option value="DOGE">DOGE</option>
      </select>
      <label for="training-window">Window Size:</label>
      <select id="training-window">
        <option value="7">7 days</option>
        <option value="14">14 days</option>
        <option value="30">30 days</option>
        <option value="90">90 days</option>
      </select>
      <button type="submit">Start Training</button>
    </form>
    <div class="training-status">
      <h3>Status</h3>
      <div id="training-status-text">Idle</div>
      <div class="progress-bar">
        <div id="training-progress-bar" style="width:0%"></div>
      </div>
    </div>
    <div>
      <span>Model Status: <span id="model-status"></span></span>
      <span>Last Training: <span id="last-training"></span></span>
      <span>Accuracy: <span id="model-accuracy"></span></span>
    </div>
  </section>

  <!-- Crypto Prices Tab -->
  <section id="tab-crypto-prices" class="tab-content">
    <h2>Crypto Prices</h2>
    <label for="price-provider">Price Provider:</label>
    <select id="price-provider" onchange="loadCryptoPrices()">
      <option value="coingecko">CoinGecko</option>
      <option value="coinmarketcap">CoinMarketCap</option>
    </select>
    <table id="crypto-table">
      <thead>
        <tr>
          <th>Symbol</th>
          <th>Name</th>
          <th>Price (USD)</th>
          <th>24h Change</th>
        </tr>
      </thead>
      <tbody>
        <!-- Prices populated by JS -->
      </tbody>
    </table>
  </section>

  <!-- System Status Tab -->
  <section id="tab-system-status" class="tab-content">
    <h2>System Status</h2>
    <div>
      <strong>Alpaca Connection (<span id="alpaca-api-url">https://paper-api.alpaca.markets</span>):</strong>
      <span id="alpaca-status" class="status-dot status-offline"></span>
      <span id="alpaca-status-text">Checking...</span>
    </div>
    <div id="alpaca-account-status"></div>
  </section>

  <!-- Scripts -->
  <script src="static/js/dashboard.js"></script>
</body>
</html>